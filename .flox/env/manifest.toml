version = 1

[vars]
GOPATH = "$HOME/go"
GOPROXY = "https://proxy.golang.org,direct"
GOSUMDB = "sum.golang.org"
GO111MODULE = "on"
CGO_ENABLED = "1"
NPM_CONFIG_PREFIX = "$FLOX_ENV_PROJECT/.flox/npm"
NODE_PATH = "$FLOX_ENV_PROJECT/.flox/npm/lib/node_modules"

[install]
go.pkg-path = "go"
go.version = "^1.24.5"

docker.pkg-path = "docker"
docker.version = "^28.3.2"
docker.pkg-group = "common"

golangci-lint.pkg-path = "golangci-lint"
golangci-lint.version = "^2.4.0"
golangci-lint.pkg-group = "common"

nodejs.pkg-path = "nodejs"
nodejs.version = "^22"
nodejs.pkg-group = "common"

pre-commit.pkg-path = "pre-commit"
pre-commit.version = "^4.2.0"
pre-commit.pkg-group = "common"

go-task.pkg-path = "go-task"
go-task.version= "^3.44.0"
go-task.pkg-group = "common"

ripgrep.pkg-path = "ripgrep"
ripgrep.version= "^14.1.1"
ripgrep.pkg-group = "common"

[hook]
on-activate = """
  mkdir -p "$NPM_CONFIG_PREFIX"
  export PATH="$PATH:$NPM_CONFIG_PREFIX/bin:$HOME/go/bin:$HOME/.local/bin"

  if [ ! -d "$NPM_CONFIG_PREFIX/lib/node_modules/semantic-release" ]; then
    echo "Installing semantic-release and plugins..."
    npm install -g \
      semantic-release@24.2.7 \
      @semantic-release/commit-analyzer@13.0.1 \
      @semantic-release/release-notes-generator@14.0.3 \
      @semantic-release/changelog@6.0.3 \
      @semantic-release/git@10.0.1 \
      @semantic-release/exec@7.1.0 \
      @semantic-release/github@11.0.3 \
      conventional-changelog-conventionalcommits@9.1.0 \
      conventional-changelog-cli@5.0.0
  fi

  if [ ! -d "$NPM_CONFIG_PREFIX/lib/node_modules/markdownlint-cli" ]; then
    echo "Installing markdownlint-cli..."
    npm install -g markdownlint-cli
  fi
"""

[profile]

[services]

[include]

[build]

[options]
