---
services:
  inference-gateway:
    image: ghcr.io/inference-gateway/inference-gateway:latest
    pull_policy: always
    ports:
      - "8080:8080"
    env_file:
      - .env.gateway
    restart: unless-stopped
    networks:
      - a2a-network

  infer-cli:
    image: golang:1.24.5
    tty: true
    working_dir: /go/src
    volumes:
      - ../..:/go/src
      - go-modules:/go/pkg/mod
      - go-build-cache:/root/.cache/go-build
    environment:
      INFER_LOGGING_DEBUG: true
      INFER_GATEWAY_URL: http://inference-gateway:8080
      INFER_A2A_ENABLED: true
      INFER_TOOLS_ENABLED: true
      INFER_AGENT_MODEL: deepseek/deepseek-chat
      INFER_AGENT_SYSTEM_PROMPT: |
        You are an helpful assistant, you have access to the following agents:
        - http://google-calendar-agent:8080
        - http://documentation-agent:8080
        - http://n8n-agent:8080
    command:
      - go
      - run
      - .
      - chat
    networks:
      - a2a-network
    profiles:
      - manual

  google-calendar-agent:
    image: ghcr.io/inference-gateway/google-calendar-agent:latest
    pull_policy: always
    env_file:
      - .env.agent
    restart: unless-stopped
    networks:
      - a2a-network

  documentation-agent:
    image: ghcr.io/inference-gateway/documentation-agent:latest
    pull_policy: always
    env_file:
      - .env.documentation
    restart: unless-stopped
    networks:
      - a2a-network

  n8n-agent:
    image: ghcr.io/inference-gateway/n8n-agent:latest
    pull_policy: always
    env_file:
      - .env.n8n
    restart: unless-stopped
    networks:
      - a2a-network

  a2a-debugger:
    image: ghcr.io/inference-gateway/a2a-debugger:latest
    pull_policy: always
    entrypoint:
      - /a2a
      - --server-url
      - http://n8n-agent:8080
    networks:
      - a2a-network
    profiles:
      - manual

networks:
  a2a-network:
    driver: bridge

volumes:
  go-modules:
  go-build-cache:
